<script lang="ts" setup>
  import { ref } from "vue";
  import contextMenu from "@/UI/contextMenu.vue";

  const props = defineProps<{
    isOpen: boolean;
  }>();
  const isWebMasterOpen = ref(false);

  const topContext = ref(0);
  const leftContext = ref(0);
  const showContext = ref(false);
  function contextOpen(e: MouseEvent) {
    topContext.value = e.pageY || e.clientY;
    leftContext.value = e.pageX || e.clientX;
    showContext.value = true;
  }
  function contextClose() {
    topContext.value = 0;
    leftContext.value = 0;
    showContext.value = false;
  }

  function webMasterOpen(e: MouseEvent) {
    if (props.isOpen) {
      isWebMasterOpen.value = !isWebMasterOpen.value;
    } else {
      contextOpen(e);
    }
  }
</script>
<template>
  <ul class="navigation__links">
    <li>
      <router-link :to="{ name: 'analitics' }" @click="isWebMasterOpen = false">
        <div class="iconMenu">
          <svg width="16" height="13" viewBox="0 0 16 13" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M9.69788 6.37319L9.65345 6.44138L9.7112 6.49873L11.1653 7.94278L10.5114 8.56265L9.08934 7.11601L9.03384 7.05954L8.96615 7.10062C8.75467 7.22896 8.54133 7.32457 8.32608 7.38812C8.1118 7.45138 7.88202 7.48333 7.63621 7.48333C6.97168 7.48333 6.39956 7.24997 5.9149 6.78027C5.4316 6.3119 5.19076 5.7391 5.19076 5.05556C5.19076 4.37201 5.4316 3.79921 5.9149 3.33084C6.39956 2.86114 6.97168 2.62778 7.63621 2.62778C8.30074 2.62778 8.87286 2.86114 9.35753 3.33084C9.84082 3.79921 10.0817 4.37201 10.0817 5.05556C10.0817 5.29944 10.0495 5.53072 9.98566 5.74979C9.92181 5.96884 9.826 6.17657 9.69788 6.37319ZM2.08167 9.38889V9.48889H2.18167H13.818H13.918V9.38889V1.44444V1.34444H13.818H2.18167H2.08167V1.44444V9.38889ZM6.53848 6.14665C6.84198 6.44805 7.2097 6.6 7.63621 6.6C8.06272 6.6 8.43044 6.44805 8.73395 6.14665C9.03748 5.84523 9.19076 5.47974 9.19076 5.05556C9.19076 4.63068 9.03391 4.26496 8.72411 3.96372C8.41549 3.66363 8.05143 3.51111 7.63621 3.51111C7.2097 3.51111 6.84198 3.66306 6.53848 3.96446C6.23495 4.26588 6.08167 4.63137 6.08167 5.05556C6.08167 5.47974 6.23495 5.84523 6.53848 6.14665ZM2.18167 10.7333C1.80817 10.7333 1.49105 10.6024 1.22486 10.3381C0.958687 10.0738 0.82712 9.75915 0.82712 9.38889V1.44444C0.82712 1.07418 0.958687 0.759584 1.22486 0.495262C1.49105 0.23092 1.80817 0.1 2.18167 0.1H13.818C14.1915 0.1 14.5086 0.23092 14.7748 0.495262C15.041 0.759584 15.1726 1.07418 15.1726 1.44444V9.38889C15.1726 9.75915 15.041 10.0738 14.7748 10.3381C14.5086 10.6024 14.1915 10.7333 13.818 10.7333H2.18167ZM0.0998474 12.9V11.6556H15.8998V12.9H0.0998474Z"
              fill="currentColor"
              stroke="white"
              stroke-width="0.2"
            />
          </svg>
        </div>

        <p v-if="isOpen">Аналитика проекта</p>
      </router-link>
    </li>
    <li class="outBut">
      <a @click="webMasterOpen">
        <div class="iconMenu">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M11.2658 2.14609C10.7865 2.2411 10.3391 2.45592 9.96529 2.77052C9.59148 3.08512 9.30341 3.48926 9.12797 3.94526L9.12735 3.94604C8.9506 4.40955 8.896 4.91072 8.96877 5.40142C9.04154 5.89212 9.23926 6.35587 9.54292 6.74813L7.58176 12.1915C7.10076 12.2929 6.65352 12.5152 6.28224 12.8373C5.91096 13.1595 5.62788 13.571 5.45972 14.0329C5.29002 14.4999 5.24325 15.0027 5.32391 15.493C5.40456 15.9833 5.60993 16.4446 5.92029 16.8326L5.9255 16.8385C6.28123 17.268 6.9797 17.1537 7.17426 16.6191L7.71616 15.1321L8.45152 15.3997L7.90983 16.8862C7.71355 17.4255 8.18259 17.958 8.73203 17.8543L8.73523 17.8538C9.21449 17.7588 9.66188 17.544 10.0357 17.2294C10.4095 16.9148 10.6976 16.5107 10.873 16.0547L10.8736 16.0539C11.0489 15.5954 11.1044 15.0999 11.0351 14.614C10.9657 14.1281 10.7736 13.6679 10.4771 13.2768L12.4526 7.80116C12.9269 7.69574 13.367 7.4724 13.732 7.15181C14.0971 6.83122 14.3754 6.42373 14.5413 5.96704C14.711 5.50004 14.7577 4.99724 14.6771 4.50695C14.5964 4.01665 14.3911 3.55533 14.0807 3.1673L14.0755 3.16139C13.7198 2.73192 13.0213 2.84626 12.8267 3.38079L12.2848 4.86784L11.5491 4.60038L12.0912 3.11374C12.2874 2.57447 11.8184 2.04188 11.2689 2.14558L11.2658 2.14609ZM11.1507 3.09719L10.6593 4.44642C10.6261 4.53636 10.611 4.63199 10.615 4.72778C10.6189 4.82358 10.6418 4.91763 10.6824 5.00453C10.7229 5.09142 10.7802 5.16942 10.851 5.23403C10.9219 5.29864 11.0048 5.34858 11.0951 5.38095L12.1311 5.75803C12.221 5.79117 12.3166 5.80618 12.4124 5.80219C12.5082 5.7982 12.6022 5.77529 12.6891 5.73477C12.776 5.69426 12.854 5.63695 12.9186 5.56615C12.9832 5.49535 13.0332 5.41245 13.0656 5.32225L13.5574 3.97282C13.7234 4.25949 13.8158 4.58284 13.8263 4.91394C13.8368 5.24505 13.765 5.57359 13.6175 5.87019C13.47 6.16679 13.2512 6.4222 12.9808 6.61357C12.7104 6.80495 12.3968 6.92633 12.068 6.96685C11.9865 6.97693 11.9095 7.00937 11.8453 7.06058C11.7811 7.11179 11.7324 7.17977 11.7045 7.25697L9.55576 13.214C9.52825 13.2902 9.5221 13.3725 9.53797 13.452C9.55385 13.5315 9.59115 13.6051 9.64584 13.6649C9.89796 13.9389 10.0688 14.2777 10.1391 14.6433C10.2095 15.0089 10.1766 15.3869 10.0442 15.735C9.94083 16.0039 9.78067 16.2473 9.57467 16.4487C9.36867 16.6502 9.12168 16.8048 8.85051 16.9021L9.34171 15.5535C9.37492 15.4636 9.38997 15.3679 9.38601 15.2721C9.38205 15.1763 9.35915 15.0823 9.31863 14.9954C9.27811 14.9085 9.22078 14.8305 9.14994 14.7659C9.07911 14.7013 8.99618 14.6513 8.90593 14.619L7.87052 14.2421C7.78058 14.209 7.68496 14.194 7.58918 14.1979C7.49341 14.2019 7.39937 14.2249 7.3125 14.2654C7.22562 14.3059 7.14762 14.3632 7.083 14.434C7.01838 14.5048 6.96842 14.5877 6.93599 14.6779L6.44439 16.0267C6.27729 15.7381 6.18484 15.4124 6.17539 15.0791C6.16595 14.7457 6.23982 14.4153 6.39031 14.1177C6.5408 13.8201 6.76315 13.5648 7.03723 13.3748C7.3113 13.1849 7.62844 13.0663 7.95992 13.0298C8.04264 13.0208 8.12116 12.9887 8.18654 12.9372C8.25193 12.8858 8.30155 12.817 8.32976 12.7387L10.4661 6.80756C10.4938 6.7305 10.4996 6.6473 10.483 6.56712C10.4664 6.48695 10.428 6.41293 10.3719 6.35322C10.1136 6.07922 9.93769 5.73799 9.86433 5.36863C9.79097 4.99927 9.82314 4.61671 9.95715 4.26478C10.0606 3.9958 10.2208 3.75228 10.4269 3.55082C10.6329 3.34936 10.88 3.19471 11.1513 3.0974"
              fill="currentColor"
            />
            <path
              d="M3.62831 6.63184L3.66418 6.59488L3.70006 6.63184L4.20254 7.14955L4.23634 7.18437L4.20254 7.2192L1.90796 9.58333L4.20254 11.9475L4.23634 11.9823L4.20254 12.0171L3.70006 12.5348L3.66418 12.5718L3.62831 12.5348L0.797449 9.61816L0.76365 9.58333L0.797449 9.54851L3.62831 6.63184Z"
              fill="currentColor"
              stroke="currentColor"
              stroke-width="0.1"
            />
            <path
              d="M16.3717 12.5348L16.3358 12.5717L16.2999 12.5348L15.7975 12.0171L15.7637 11.9823L15.7975 11.9474L18.092 9.58329L15.7975 7.21916L15.7637 7.18433L15.7975 7.14951L16.2999 6.6318L16.3358 6.59484L16.3717 6.6318L19.2026 9.54847L19.2364 9.58329L19.2026 9.61812L16.3717 12.5348Z"
              fill="currentColor"
              stroke="currentColor"
              stroke-width="0.1"
            />
          </svg>
        </div>

        <p v-if="isOpen">Позиции из Я.Вебмастера</p>
        <div v-if="isOpen" class="dropIcon">
          <svg v-if="!isWebMasterOpen" width="6" height="4" viewBox="0 0 6 4" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M5.57143 3.74669e-08C5.65102 3.05089e-08 5.72904 0.0206857 5.79674 0.0597396C5.86445 0.0987935 5.91916 0.154672 5.95475 0.221115C5.99035 0.287557 6.00542 0.361938 5.99827 0.435922C5.99112 0.509907 5.96204 0.580572 5.91429 0.64L3.34286 3.84C3.30294 3.88968 3.25117 3.93 3.19166 3.95777C3.13215 3.98554 3.06653 4 3 4C2.93347 4 2.86785 3.98554 2.80834 3.95777C2.74883 3.93 2.69706 3.88968 2.65714 3.84L0.085716 0.640001C0.0379617 0.580573 0.00888031 0.509907 0.00173251 0.435923C-0.00541528 0.361938 0.00965324 0.287557 0.0452472 0.221115C0.0808412 0.154673 0.135555 0.098794 0.203259 0.0597401C0.270963 0.0206862 0.348982 4.94028e-07 0.428573 4.8707e-07L5.57143 3.74669e-08Z"
              fill="currentColor"
            />
          </svg>
          <svg v-else width="6" height="4" viewBox="0 0 6 4" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M0.428388 4C0.348798 4 0.270779 3.97931 0.203075 3.94026C0.135371 3.90121 0.0806566 3.84533 0.0450625 3.77889C0.00946843 3.71244 -0.00559888 3.63806 0.00154882 3.56408C0.00869653 3.49009 0.0377768 3.41943 0.0855313 3.36L2.65696 0.16C2.69688 0.110322 2.74864 0.0700002 2.80815 0.0422291C2.86766 0.014458 2.93328 0 2.99982 0C3.06635 0 3.13197 0.014458 3.19148 0.0422291C3.25099 0.0700002 3.30275 0.110322 3.34267 0.16L5.9141 3.36C5.96186 3.41943 5.99094 3.49009 5.99809 3.56408C6.00523 3.63806 5.99016 3.71244 5.95457 3.77889C5.91898 3.84533 5.86426 3.90121 5.79656 3.94026C5.72885 3.97931 5.65084 4 5.57124 4L0.428388 4Z"
              fill="currentColor"
            />
          </svg>
        </div>
      </a>
      <ul v-if="isOpen" v-show="isWebMasterOpen" class="dropdown-menu">
        <li>
          <router-link :to="{ name: 'requestsWebMaster' }">Запросы Я.Вебмастер</router-link>
        </li>
        <li>
          <router-link :to="{ name: 'urlWebMaster' }">URLs Я.Вебмастер</router-link>
        </li>
      </ul>
    </li>
    <li>
      <router-link :to="{ name: 'liveSearch' }" @click="isWebMasterOpen = false">
        <div class="iconMenu">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M7.75421 12.8457H7.09057C5.76625 12.8457 4.49662 12.3318 3.56087 11.4177C2.62521 10.5036 2.1 9.26445 2.1 7.97285C2.1 6.68126 2.62521 5.44207 3.56087 4.52805C4.49662 3.61394 5.76625 3.1 7.09057 3.1H12.9084H12.9084C13.7508 3.09983 14.5795 3.30789 15.3172 3.70466C16.0549 4.10142 16.6776 4.67393 17.1275 5.36867C17.5774 6.0634 17.8399 6.85784 17.8909 7.67804C17.9376 8.43061 17.8048 9.18261 17.504 9.87516C17.2611 9.4237 16.9499 9.01041 16.5806 8.64937C16.6797 8.13537 16.6648 7.60632 16.5365 7.09808C16.4037 6.57192 16.1528 6.08137 15.8021 5.66193C15.4515 5.24249 15.0099 4.90467 14.5094 4.67279C14.009 4.4409 13.4621 4.32071 12.9084 4.32081C12.9084 4.32081 12.9084 4.32081 12.9084 4.32081H7.09057C6.10044 4.32081 5.1504 4.70503 4.44957 5.38965C3.74866 6.07435 3.35445 7.00351 3.35445 7.97285C3.35445 8.9422 3.74866 9.87136 4.44957 10.5561C5.1504 11.2407 6.10044 11.6249 7.09057 11.6249H7.75421C7.70392 12.0303 7.70392 12.4403 7.75421 12.8457ZM15.8595 14.1379L15.8127 14.207L15.8725 14.2654L17.6428 15.9955L16.7576 16.8602L14.9832 15.1276L14.9261 15.0718L14.8591 15.1151C14.326 15.4593 13.7073 15.6561 13.0686 15.6844C12.4299 15.7126 11.7954 15.5713 11.2325 15.2756C10.6697 14.9799 10.1998 14.5409 9.87231 14.0056C9.54489 13.4703 9.37215 12.8585 9.37225 12.2353C9.37238 11.6975 9.50125 11.167 9.74868 10.6863C9.99611 10.2056 10.3553 9.78779 10.7978 9.46646C11.2402 9.14513 11.7536 8.9292 12.297 8.83609C12.8405 8.74298 13.3986 8.77529 13.9269 8.93042C14.4552 9.08554 14.9388 9.35914 15.3393 9.72917C15.7397 10.0992 16.0458 10.5554 16.2334 11.0612C16.4209 11.567 16.4848 12.1086 16.4199 12.6427C16.355 13.1768 16.1632 13.6888 15.8595 14.1379ZM12.9084 10.0041C12.304 10.0041 11.7239 10.2386 11.2958 10.6568C10.8677 11.075 10.6267 11.6428 10.6267 12.2353C10.6267 12.8278 10.8677 13.3956 11.2958 13.8138C11.7239 14.232 12.304 14.4665 12.9084 14.4665C13.5128 14.4665 14.0929 14.232 14.5209 13.8138C14.9491 13.3956 15.19 12.8278 15.19 12.2353C15.19 11.6428 14.9491 11.075 14.5209 10.6568C14.0929 10.2386 13.5128 10.0041 12.9084 10.0041Z"
              fill="currentColor"
              stroke="white"
              stroke-width="0.2"
            />
          </svg>
        </div>

        <p v-if="isOpen">Съем позиций (Live/XML)</p>
      </router-link>
    </li>
    <hr />
    <li>
      <router-link :to="{ name: 'project' }" @click="isWebMasterOpen = false">
        <div class="iconMenu">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M3.57778 7.33333V7.53333H3.77778H7.33333H7.53333V7.33333V3.77778V3.57778H7.33333H3.77778H3.57778V3.77778V7.33333ZM12.4667 7.33333V7.53333H12.6667H16.2222H16.4222V7.33333V3.77778V3.57778H16.2222H12.6667H12.4667V3.77778V7.33333ZM12.4667 16.2222V16.4222H12.6667H16.2222H16.4222V16.2222V12.6667V12.4667H16.2222H12.6667H12.4667V12.6667V16.2222ZM3.57778 16.2222V16.4222H3.77778H7.33333H7.53333V16.2222V12.6667V12.4667H7.33333H3.77778H3.57778V12.6667V16.2222ZM2.2 8.91111V2.2H8.91111V8.91111H2.2ZM2.2 17.8V11.0889H8.91111V17.8H2.2ZM11.0889 8.91111V2.2H17.8V8.91111H11.0889ZM11.0889 17.8V11.0889H17.8V17.8H11.0889Z"
              fill="currentColor"
              stroke="white"
              stroke-width="0.4"
            />
          </svg>
        </div>

        <p v-if="isOpen">Мои проекты</p>
      </router-link>
    </li>
  </ul>
  <contextMenu class="contextMenu" :display="showContext" :top="topContext" :left="leftContext" @close="contextClose">
    <ul v-if="!isOpen" class="dropdown-menu navigation__links">
      <li>
        <router-link :to="{ name: 'requestsWebMaster' }">Ключевые слова</router-link>
      </li>
      <li>
        <router-link :to="{ name: 'urlWebMaster' }">URLs</router-link>
      </li>
    </ul>
  </contextMenu>
</template>
<style scoped lang="scss">
  .navigation__links {
    display: flex;
    flex-direction: column;
    width: max-content;
    padding: 0;
    margin: 0;
    text-align: center;
    & hr {
      margin: 8px 0 8px 0;
      width: 100%;
      border: 0.5px solid #e5e5ea;
    }
    & li {
      list-style-type: none;
      cursor: pointer;
      & a {
        padding: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: transform 0.2s ease;

        & p {
          margin: 0;
        }
        & img {
          aspect-ratio: 1/1;
          width: 20px;
          height: 20px;
        }
      }
    }

    & a:hover {
      background: #f7f7f7;
      border-radius: 3px;
      color: #404040 !important; // Меняем цвет текста
    }
    & .outBut:has(ul li .router-link-active) p {
      color: #404040 !important;
    }
    & .router-link-active {
      color: #404040 !important;
    }
  }
  .iconMenu {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
  }
  .dropIcon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
  }
</style>
